/*
   For readable source code, check the 'hubs: 
   http://github.com/lachlanhardy/lachstock/blob/master/public/javascripts/github-activity.js 
*/

function githubActivity(){if($("#github").length!=0){var b="lachlanhardy";var a="";$.getJSON("http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20atom%20where%20url%3D%22http%3A%2F%2Fgithub.com%2F"+b+".atom%22&format=json&callback=?",function(h){var g=h.query.results.entry;$(g).each(function(m){var k=g[m].id;var j=k.match(/([^\/]*):([^\/]*)\/([^\/]*)$/);var l=j[2];switch(l){case"CommitEvent":if(a==""){a=g[m].link.href;titleText=" committed to ";return a;return titleText}break;case"FollowEvent":break;case"GistEvent":break;case"WikiEvent":break}});var d=a.match(/http:\/\/github.com\/([^\/]*)\/([^\/]*)\/commit\/([^\/]*)$/);var c=d[1];var e=d[2];var i=d[3];var f=c+"/"+e;$.getJSON("http://github.com/api/v1/json/"+f+"/commit/"+i+"?callback=?",function(o){var p=$(document.createElement("dl"));var k=$(document.createElement("dt"));var j=$(document.createElement("strong"));var n=$(document.createElement("a"));n.attr("href","http://github.com/"+b).attr("rel","me").text(b);j.append(n).append(titleText);var m=$(document.createElement("a"));m.attr("href","http://github.com/"+f).text(f);j.append(m);var q=$(document.createElement("span"));var t=parseDate(o.commit.committed_date);q.addClass("date").text(t).attr("title",t);q.prettyDate();setInterval(function(){q.prettyDate()},5000);k.append(j).append(q);var s=$(document.createElement("dd"));messageAnchor=$(document.createElement("a"));messageAnchor.attr("href",a).text(o.commit.message);s.append(messageAnchor);var r=$(document.createElement("dd"));r.addClass("filenames");var l=$(document.createElement("ul"));$(o.commit.modified).each(function(u){l.append($(document.createElement("li")).text(o.commit.modified[u].filename))});r.append(l);p.append(k).append(s).append(r);$("#github p").replaceWith(p)})})}}function parseDate(c){var a=10;c=c.substring(0,19)+"Z";var b=c.substring(11,13);var d=parseInt(b,1)+7+a;if(d>24){d=d-24}c=c.replace("T"+b,"T"+d);return c};